<!--pages/storageConsole/storageConsole.wxml-->
<wxs module="m1">
  // 不可使用es6语法
  var genres = function (genres) {
    return genres.join(',')
  }

  var avatars = function (directors, casts) {
    console.log(directors)
    return directors.concat(casts)
  }

  module.exports.genres = genres
  module.exports.avatars = avatars
</wxs>

<view class="container" wx:if="{{detail.title}}">
  <view></view>
  <text></text>
  <view class="details-panel">
    <view class="movie-filter"></view>
    <view class="panel-bg" style="background-image: url({{detail.images.large}})"></view>
    <view class="main">
      <view class="image" bindtap="watchTrailer">
        <image src="{{detail.images.large}}"></image>
      </view>
      <view class="describe">
        <view class="name-cn ellipsis">{{detail.title}}<text class="douban-rating ellipsis">豆瓣评分：{{detail.rating.average}}</text></view>
        <text class="name-en ellipsis">{{detail.original_title}}</text>
        <view class="ellipsis" style="margin-top: 22rpx;">
          <text class="wish-count ellipsis">{{detail.wish_count}}人想看</text>
        </view>
        <text class="genres ellipsis">{{m1.genres(detail.genres)}}</text>
        <text class="length ellipsis">{{detail.countries[0]}}/{{detail.durations[0]}}</text>
        <text class="pubdate ellipsis">{{detail.pubdate}} 大陆上映</text>
      </view>
    </view>
  </view>

  <!-- 简介 -->
  <view class="panel">
    <panel summary="{{detail.summary}}"></panel>
  </view>

  <!-- 演员表 -->
  <view class="actors">
    <text class="title">演职人员</text>
    <scroll-view scroll-x="true" style="white-space: nowrap; display: flex; margin-top: 20rpx;">
      <view class="actor" wx:key="index" wx:for="{{m1.avatars(detail.directors, detail.casts)}}">
        <image class="avatar" src="{{item.avatars.large}}"></image>
        <text class="name-en ellipsis">{{item.name_en}}</text>
        <text class="name-cn ellipsis">{{item.name}}</text>
      </view>
      <view class="actor" wx:key="index" wx:for="{{m1.avatars(detail.directors, detail.casts)}}">
        <image class="avatar" src="{{item.avatars.large}}"></image>
        <text class="name-en ellipsis">{{item.name_en}}</text>
        <text class="name-cn ellipsis">{{item.name}}</text>
      </view>
    </scroll-view>
  </view>

</view>
